<!DOCTYPE html>
<html>
  <head>
    <base href="@@base@@" />
    <meta charset="utf-8" />
    <link rel="stylesheet" href="engine/main.css" />
    <link rel="stylesheet" href="theme/vancouver.css" />
    <link rel="stylesheet" href="engine/katex/katex.min.css" />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <style>
    :root{
--logo: /assets/200611_spin_imagotipo_negativo.png;
--darkaccent1color: #A7987C;
--lightaccent1color: #A7987C;
--accent2: #43aa8b;
--accent3: #f9c74f;
--accent4: #90be6d;
--accent5: #f8961e;
--accent6: #577590;
--lighttitletextcolor: #ffffffEE;
--darktitletextcolor: #000000EE;
--lightbodytextcolor: #ffffffEE;
--darkbodytextcolor: #000000EE;
--lightbackgroundcolor: transparent;
--darkbackgroundcolor: transparent;
--bodyfont: Montserrat;
--titlefont: Montserrat;
} 

    </style>
    <link
      rel="stylesheet"
      type="text/css"
      href="engine/print.css"
      media="print"
    />
  </head>

  <body class="responsive">
    <div class="reveal">
      <div class="slides"><section class="variable-size-headings has-footer dark section-container present has-dark-background fitted" data-background-color="#4d4036" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-section" style="width: 100%; font-size: 1rem;">
        <div style="">
          <h3 id="denoisingofmulti-echofmridatawithtedana">Denoising of multi-echo fMRI data with tedana</h3>
        </div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">1</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
</section><section class="variable-size-headings has-footer dark default-container present has-dark-background fitted" data-background-color="#514137" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default media-grid" style="width: 100%; font-size: 1rem;">
        <div style=""><div class="single-image-wrapper"><img src="images/qr.png" class=" size-contain position-center-center"></div><p></p>

<h3 id="slidesavailableonline">Slides available online</h3></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">2</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark default-container present has-dark-background fitted" data-background-color="#564238" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 1rem;">
        <div style=""><h3 id="createacondaormambaenvironment">Create a conda or mamba environment</h3>

<p>As simple as:</p>

<pre><code class="bash hljs">$ mamba create -p ~/conda_envs/MRITogether python=3.8
$ <span class="hljs-built_in">source</span> activate ~/conda_envs/MRITogether
</code></pre></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">3</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark default-container present has-dark-background fitted" data-background-color="#5b4339" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 1rem;">
        <div style=""><h3 id="installtedana">Install tedana</h3>

<p>As simple as:</p>

<p><br></p>

<pre><code class="bash hljs">$ pip install tedana
</code></pre></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">4</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark default-container present has-dark-background fitted" data-background-color="#5f443a" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 1rem;">
        <div style=""><h3 id="checkyou’reonthelatestversion">Check you’re on the latest version</h3>

<p><br></p>

<pre><code class="bash hljs">$ tedana --version
tedana v0.0.12
</code></pre></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">5</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark default-container present has-dark-background fitted" data-background-color="#64453b" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 1rem;">
        <div style=""><h3 id="createdatafolder">Create data folder</h3>

<p><br></p>

<pre><code class="bash hljs">$ mkdir ~/MRITogether
$ <span class="hljs-built_in">cd</span> ~/MRITogether
</code></pre></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">6</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark default-container present has-dark-background fitted" data-background-color="#69463c" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default media-grid" style="width: 100%; font-size: 1rem;">
        <div style=""><div class="single-image-wrapper"><img src="images/osf_screenshot.png" class=" size-contain position-center-center"></div><p></p>

<p>Data: <a href="https://osf.io/9wcb8/">https://osf.io/9wcb8/</a></p></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">7</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark default-container present has-dark-background fitted" data-background-color="#6e473d" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default media-grid" style="width: 100%; font-size: 1rem;">
        <div style=""><div class="single-image-wrapper"><img src="images/download_data.png" class=" size-contain position-center-center"></div><p></p>

<p>Download subject data as zip</p></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">8</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark default-container present has-dark-background fitted" data-background-color="#72493f" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 1rem;">
        <div style=""><h3 id="movedataandunzip">Move data and unzip</h3>

<p><br></p>

<pre><code class="bash hljs">$ mv ~/Downloads/sub-04570.zip .
$ unzip sub-04570.zip
$ rm -rf sub-04570.zip
</code></pre></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">9</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark default-container present has-dark-background fitted" data-background-color="#725348" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 1rem;">
        <div style=""><h3 id="whatdowehavehere">What do we have here?</h3>

<p><br></p>

<pre><code class="bash hljs">$ ls -lah
total 0
drwxr-xr-x   6 eurunuela  staff   192B Dec  1 15:27 .
drwxr-x---+ 76 eurunuela  staff   2.4K Dec  1 15:27 ..
drwxr-xr-x  19 eurunuela  staff   608B Dec  1 15:26 anat
drwxr-xr-x  14 eurunuela  staff   448B Dec  1 15:26 figures
drwxr-xr-x  11 eurunuela  staff   352B Dec  1 15:26 func
drwxr-xr-x   3 eurunuela  staff    96B Dec  1 15:26 <span class="hljs-built_in">log</span>
</code></pre></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">10</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark default-container present fit-warning has-dark-background fitted" data-background-color="#725d51" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 0.719rem;">
        <div style=""><p><br></p>

<pre><code class="bash hljs">$ ls -lah func/
total 384520
drwxr-xr-x  11 eurunuela  staff   352B Dec  1 15:26 .
drwxr-xr-x   6 eurunuela  staff   192B Dec  1 15:27 ..
-rw-------   1 eurunuela  staff   151K Dec  1 14:15 sub-04570_task-rest_desc-confounds_timeseries.json
-rw-------   1 eurunuela  staff   509K Dec  1 14:15 sub-04570_task-rest_desc-confounds_timeseries.tsv
-rw-------   1 eurunuela  staff    49M Dec  1 14:15 sub-04570_task-rest_echo-1_space-scanner_desc-partialPreproc_bold.nii.gz
-rw-------   1 eurunuela  staff    47M Dec  1 14:14 sub-04570_task-rest_echo-2_space-scanner_desc-partialPreproc_bold.nii.gz
-rw-------   1 eurunuela  staff    46M Dec  1 14:14 sub-04570_task-rest_echo-3_space-scanner_desc-partialPreproc_bold.nii.gz
-rw-------   1 eurunuela  staff    45M Dec  1 14:14 sub-04570_task-rest_echo-4_space-scanner_desc-partialPreproc_bold.nii.gz
-rw-------   1 eurunuela  staff   247B Dec  1 14:14 sub-04570_task-rest_from-T1w_to-scanner_mode-image_xfm.txt
-rw-------   1 eurunuela  staff   247B Dec  1 14:14 sub-04570_task-rest_from-scanner_to-T1w_mode-image_xfm.txt
-rw-------   1 eurunuela  staff   3.4K Dec  1 14:14 sub-04570_task-rest_space-scanner_desc-brain_mask.nii.gz
</code></pre></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">11</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark section-container present has-dark-background fitted" data-background-color="#726659" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-section" style="width: 100%; font-size: 1rem;">
        <div style="">
          <h3 id="wearereadytogo">We are ready to go!</h3>
        </div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">12</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
</section><section class="variable-size-headings has-footer dark default-container present has-dark-background fitted" data-background-color="#727062" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 1rem;">
        <div style=""><h3 id="thetedanacommand">The tedana command</h3>

<p><br></p>

<pre><code class="bash hljs">$ tedana -d func/sub-04570_task-rest_echo-1_space-scanner_desc-partialPreproc_bold.nii.gz func/sub-04570_task-rest_echo-2_space-scanner_desc-partialPreproc_bold.nii.gz func/sub-04570_task-rest_echo-3_space-scanner_desc-partialPreproc_bold.nii.gz func/sub-04570_task-rest_echo-4_space-scanner_desc-partialPreproc_bold.nii.gz -e 12 28 44 60 --mask func/sub-04570_task-rest_space-scanner_desc-brain_mask.nii.gz --out-dir tedana --tedpca mdl --prefix sub-04570_task-rest_space-scanner --fittype curvefit --verbose
</code></pre></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">13</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark default-container present has-dark-background fitted" data-background-color="#72796b" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 1rem;">
        <div style=""><h3 id="let’schecktheoutputs">Let’s check the outputs</h3>

<p><br></p>

<pre><code class="bash hljs">$ ls
anat    figures func    <span class="hljs-built_in">log</span>     tedana
</code></pre></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">14</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark v-split-container present has-dark-background fitted" data-background-color="#728374" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-v-split media-grid" style="width: 100%; font-size: 1rem;">
        <div style=""><h3 id="wegetabunchoffiles">We get a bunch of files</h3>

<p><code class="hljs powershell"><span class="hljs-variable">$</span> <span class="hljs-built_in">ls</span> tedana</code></p>

<ul>
<li><span class="math katex-rendered"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">S_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0576em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="math katex-rendered"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mn>2</mn><mo>∗</mo></msubsup></mrow><annotation encoding="application/x-tex">T_2^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.9368em; vertical-align: -0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6887em;"><span class="" style="top: -2.4519em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2481em;"><span class=""></span></span></span></span></span></span></span></span></span></span> maps</li>
<li>PCA and ICA metrics</li>
<li>Optimally combined data</li>
<li>Each of the echoes</li>
<li>A mask of the good data</li>
<li>A folder with component figures</li>
</ul></div>
        <img src="images/tedana_outputs.png" class=" size-contain position-center-center" style="">
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">15</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
</section><section class="variable-size-headings has-footer dark v-split-container present has-light-background fitted" data-background-color="#728d7c" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-v-split media-grid" style="width: 100%; font-size: 1rem;">
        <img src="images/tedana_json.png" class=" size-contain position-center-center" style="">
        <img src="images/tedana_log.png" class=" size-contain position-center-center" style="">
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">16</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
</section><section class="variable-size-headings has-footer dark section-container present has-light-background fitted" data-background-color="#749381" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-section" style="width: 100%; font-size: 1rem;">
        <div style="">
          <h3 id="automaticclassificationoficacomponentsisnotperfect">Automatic classification of ICA components is not perfect</h3>
        </div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">17</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
</section><section class="variable-size-headings has-footer dark full-image-container present has-light-background fitted" data-background-color="#779580" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-full-image media-grid" style="width: 100%; font-size: 1rem;">
        <div style=""><div class="single-image-wrapper"><img src="images/metrics_table.png" class=" position-center-center"></div></div>
        
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">18</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
</section><section class="variable-size-headings has-footer dark cover-container present has-light-background fitted" data-background-color="#7b977f" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-cover" style="width: 100%; font-size: 1rem;">
        <div style=""><h1 id="rica">Rica</h1>

<h3 id="easyfastwaytovisualizeandclassifycomponents">Easy, fast way to visualize and classify components</h3></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">19</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark title-container present has-light-background fitted" data-background-color="#7e987e" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-title" style="width: 100%; font-size: 1rem;">
        <div style=""><h2 id="rica-fmri.netlify.app"><a href="rica-fmri.netlify.app">rica-fmri.netlify.app</a></h2></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">20</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark section-container present has-light-background fitted" data-background-color="#829a7c" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-section" style="width: 100%; font-size: 1rem;">
        <div style="">
          <h3 id="ifyoudoorwanttodowebdevandwanttocontributedmme🙏">If you do (or want to do) web dev and want to contribute, DM me! 🙏</h3>
        </div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">21</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
</section><section class="variable-size-headings has-footer dark section-container present has-light-background fitted" data-background-color="#859b7b" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-section" style="width: 100%; font-size: 1rem;">
        <div style="">
          <h3 id="ricamakesiteasytoruntedanawithourmanualclassification">Rica makes it easy to run tedana with our manual classification</h3>
        </div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">22</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
</section><section class="variable-size-headings has-footer dark default-container present has-light-background fitted" data-background-color="#899d7a" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 1rem;">
        <div style=""><h3 id="tedanawithmanualclassification">tedana with manual classification</h3>

<p><br></p>

<pre><code class="bash hljs">$ tedana -d func/sub-04570_task-rest_echo-1_space-scanner_desc-partialPreproc_bold.nii.gz func/sub-04570_task-rest_echo-2_space-scanner_desc-partialPreproc_bold.nii.gz func/sub-04570_task-rest_echo-3_space-scanner_desc-partialPreproc_bold.nii.gz func/sub-04570_task-rest_echo-4_space-scanner_desc-partialPreproc_bold.nii.gz -e 12 28 44 60 --mask func/sub-04570_task-rest_space-scanner_desc-brain_mask.nii.gz --out-dir tedana_manual --prefix sub-04570_task-rest_space-scanner --verbose --t2smap tedana/sub-04570_task-rest_space-scanner_T2starmap.nii.gz --mix tedana/sub-04570_task-rest_space-scanner_desc-ICA_mixing.tsv --ctab tedana/manual_classification.tsv
</code></pre></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">23</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark default-container present has-light-background fitted" data-background-color="#8c9f79" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 1rem;">
        <div style=""><pre><code class="python hljs"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">from</span> nilearn.plotting <span class="hljs-keyword">import</span> plot_carpet

fig, axs = plt.subplots(<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)
axs[<span class="hljs-number">0</span>] = plot_carpet(<span class="hljs-string">"sub-04570_task-rest_space-scanner_desc-optcom_bold.nii.gz"</span>, <span class="hljs-string">"../func/sub-04570_task-rest_space-scanner_desc-brain_mask.nii.gz"</span>)
axs[<span class="hljs-number">1</span>] = plot_carpet(<span class="hljs-string">"sub-04570_task-rest_space-scanner_desc-optcomDenoised_bold.nii.gz"</span>, <span class="hljs-string">"../func/sub-04570_task-rest_space-scanner_desc-brain_mask.nii.gz"</span>)
</code></pre></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">24</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark v-split-container present has-light-background fitted" data-background-color="#8f9e77" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-v-split media-grid" style="width: 100%; font-size: 1rem;">
        <div style=""><div class="single-image-wrapper"><img src="images/before.png" class=" size-contain position-center-center"></div><p></p>

<p>Before</p></div>
        <div style=""><div class="single-image-wrapper"><img src="images/after.png" class=" size-contain position-center-center"></div><p></p>

<p>After</p></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">25</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
</section><section class="variable-size-headings has-footer dark section-container present has-light-background fitted" data-background-color="#929c75" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-section" style="width: 100%; font-size: 1rem;">
        <div style="">
          <h3 id="differentlevelsofdenoising">Different levels of denoising</h3>
        </div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">26</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
</section><section class="variable-size-headings has-footer dark default-container present fit-warning has-light-background fitted" data-background-color="#969b74" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 0.766rem;">
        <div style=""><pre><code class="python hljs"><span class="hljs-keyword">from</span> os.path <span class="hljs-keyword">import</span> join <span class="hljs-keyword">as</span> opj
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd  <span class="hljs-comment"># A library for working with tabular data</span>

<span class="hljs-comment"># Files from fMRIPrep</span>
data_file = <span class="hljs-string">"sub-04570_task-rest_space-scanner_desc-optcom_bold.nii.gz"</span>
mask_file = <span class="hljs-string">"sub-04570_task-rest_space-scanner_desc-brain_mask.nii.gz"</span>
confounds_file = <span class="hljs-string">"sub-04570_task-rest_desc-confounds_timeseries.tsv"</span>

<span class="hljs-comment"># Files from tedana (after running on fMRIPrepped data)</span>
mixing_file = <span class="hljs-string">"sub-04570_task-rest_space-scanner_desc-ICA_mixing.tsv"</span>
metrics_file = <span class="hljs-string">"sub-04570_task-rest_space-scanner_desc-tedana_metrics.tsv"</span>

<span class="hljs-comment"># Load the mixing matrix</span>
mixing_df = pd.read_table(opj(<span class="hljs-string">"tedana_manual"</span>,mixing_file))  <span class="hljs-comment"># Shape is time-by-components</span>

<span class="hljs-comment"># Load the component table</span>
metrics_df = pd.read_table(opj(<span class="hljs-string">"tedana_manual"</span>, metrics_file))
rejected_columns = metrics_df.loc[metrics_df[<span class="hljs-string">"classification"</span>] == <span class="hljs-string">"rejected"</span>, <span class="hljs-string">"Component"</span>]
accepted_columns = metrics_df.loc[metrics_df[<span class="hljs-string">"classification"</span>] == <span class="hljs-string">"accepted"</span>, <span class="hljs-string">"Component"</span>]
</code></pre></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">27</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark default-container present has-light-background fitted" data-background-color="#999972" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 0.859rem;">
        <div style=""><pre><code class="python hljs"><span class="hljs-comment"># Load the fMRIPrep confounds file</span>
confounds_df = pd.read_table(opj(<span class="hljs-string">"func"</span>, confounds_file))

<span class="hljs-comment"># Select external nuisance regressors we want to use for denoising</span>
confounds = confounds_df[
    [
        <span class="hljs-string">"trans_x"</span>,
        <span class="hljs-string">"trans_y"</span>,
        <span class="hljs-string">"trans_z"</span>,
        <span class="hljs-string">"rot_x"</span>,
        <span class="hljs-string">"rot_y"</span>,
        <span class="hljs-string">"rot_z"</span>,
        <span class="hljs-string">"csf"</span>,
        <span class="hljs-string">"white_matter"</span>,
    ]
].to_numpy()

<span class="hljs-comment"># Select "bad" components from the mixing matrix</span>
rejected_components = mixing_df[rejected_columns].to_numpy()
accepted_components = mixing_df[accepted_columns].to_numpy()
</code></pre></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">28</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark section-container present has-light-background fitted" data-background-color="#9c9770" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-section" style="width: 100%; font-size: 1rem;">
        <div style="">
          <h3 id="aggressivedenoising">Aggressive denoising</h3>

<h4 id="removeallnoise-correlatedfluctuations">Remove all noise-correlated fluctuations</h4>
        </div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">29</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
</section><section class="variable-size-headings has-footer dark default-container present fit-warning has-light-background fitted" data-background-color="#9f956e" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 0.625rem;">
        <div style=""><pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np  <span class="hljs-comment"># A library for working with numerical data</span>
<span class="hljs-keyword">from</span> nilearn.maskers <span class="hljs-keyword">import</span> NiftiMasker  <span class="hljs-comment"># A class for masking and denoising fMRI data</span>

<span class="hljs-comment"># Combine the rejected components and the fMRIPrep confounds into a single array</span>
regressors = np.hstack((rejected_components, confounds))

masker = NiftiMasker(
    mask_img=opj(<span class="hljs-string">"func"</span>, mask_file),
    standardize_confounds=<span class="hljs-literal">True</span>,
    standardize=<span class="hljs-literal">False</span>,
    smoothing_fwhm=<span class="hljs-literal">None</span>,
    detrend=<span class="hljs-literal">False</span>,
    low_pass=<span class="hljs-literal">None</span>,
    high_pass=<span class="hljs-literal">None</span>,
    t_r=<span class="hljs-literal">None</span>,  <span class="hljs-comment"># This shouldn't be necessary since we aren't bandpass filtering</span>
    reports=<span class="hljs-literal">False</span>,
)

<span class="hljs-comment"># Denoise the data by fitting and transforming the data file using the masker</span>
denoised_img_2d = masker.fit_transform(opj(<span class="hljs-string">"tedana_manual"</span>, data_file), confounds=regressors)

<span class="hljs-comment"># Transform denoised data back into 4D space</span>
denoised_img_4d = masker.inverse_transform(denoised_img_2d)

<span class="hljs-comment"># Save to file</span>
denoised_img_4d.to_filename(
    opj(<span class="hljs-string">"func"</span>, <span class="hljs-string">"sub-04570_task-rest_space-scanner_desc-aggrDenoised_bold.nii.gz"</span>)
)
</code></pre></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">30</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark section-container present has-light-background fitted" data-background-color="#a2936c" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-section" style="width: 100%; font-size: 1rem;">
        <div style="">
          <h3 id="non-aggresivedenoising">Non-aggresive denoising</h3>

<h4 id="removenoise-correlatedfluctuationsthatarenotcorrelatedwithacceptedcomponents">Remove noise-correlated fluctuations that are not correlated with accepted components</h4>
        </div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">31</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
</section><section class="variable-size-headings has-footer dark default-container present fit-warning has-light-background fitted" data-background-color="#a5916a" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 0.625rem;">
        <div style=""><pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np  <span class="hljs-comment"># A library for working with numerical data</span>
<span class="hljs-keyword">from</span> nilearn.masking <span class="hljs-keyword">import</span> apply_mask, unmask  <span class="hljs-comment"># Functions for (un)masking fMRI data</span>

<span class="hljs-comment"># Apply the mask to the data image to get a 2d array</span>
data = apply_mask(opj(<span class="hljs-string">"tedana_manual"</span>, data_file), opj(<span class="hljs-string">"func"</span>, mask_file))

<span class="hljs-comment"># Fit GLM to accepted components, rejected components and nuisance regressors</span>
<span class="hljs-comment"># (after adding a constant term)</span>
regressors = np.hstack(
    (
        confounds,
        rejected_components,
        accepted_components,
        np.ones((mixing_df.shape[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>)),
    ),
)
betas = np.linalg.lstsq(regressors, data, rcond=<span class="hljs-literal">None</span>)[<span class="hljs-number">0</span>][:-<span class="hljs-number">1</span>]

<span class="hljs-comment"># Denoise the data using the betas from just the bad components</span>
confounds_idx = np.arange(confounds.shape[<span class="hljs-number">1</span>] + rejected_components.shape[<span class="hljs-number">1</span>])
pred_data = np.dot(np.hstack((confounds, rejected_components)), betas[confounds_idx, :])
data_denoised = data - pred_data

<span class="hljs-comment"># Save to file</span>
denoised_img = unmask(data_denoised, opj(<span class="hljs-string">"func"</span>, mask_file))
denoised_img.to_filename(
    opj(<span class="hljs-string">"func"</span>, <span class="hljs-string">"sub-04570_task-rest_space-scanner_desc-nonaggrDenoised_bold.nii.gz"</span>)
)
</code></pre></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">32</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark section-container present has-light-background fitted" data-background-color="#a28f6c" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-section" style="width: 100%; font-size: 1rem;">
        <div style="">
          <h3 id="orthogonalizethenoisecomponentsw.r.t.theacceptedcomponentspriortodenoising">Orthogonalize the noise components w.r.t. the accepted components prior to denoising</h3>
        </div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">33</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
</section><section class="variable-size-headings has-footer dark default-container present fit-warning has-light-background fitted" data-background-color="#9e8e70" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 0.531rem;">
        <div style=""><pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np  <span class="hljs-comment"># A library for working with numerical data</span>
<span class="hljs-keyword">from</span> nilearn.maskers <span class="hljs-keyword">import</span> NiftiMasker  <span class="hljs-comment"># A class for masking and denoising fMRI data</span>

<span class="hljs-comment"># Combine the confounds and rejected components in a single array</span>
bad_timeseries = np.hstack((rejected_components, confounds))

<span class="hljs-comment"># Regress the good components out of the bad time series to get "pure evil" regressors</span>
betas = np.linalg.lstsq(accepted_components, bad_timeseries, rcond=<span class="hljs-literal">None</span>)[<span class="hljs-number">0</span>]
pred_bad_timeseries = np.dot(accepted_components, betas)
orth_bad_timeseries = bad_timeseries - pred_bad_timeseries

<span class="hljs-comment"># Once you have these "pure evil" components, you can denoise the data</span>
masker = NiftiMasker(
    mask_img=opj(<span class="hljs-string">"func"</span>, mask_file),
    standardize_confounds=<span class="hljs-literal">True</span>,
    standardize=<span class="hljs-literal">False</span>,
    smoothing_fwhm=<span class="hljs-literal">None</span>,
    detrend=<span class="hljs-literal">False</span>,
    low_pass=<span class="hljs-literal">None</span>,
    high_pass=<span class="hljs-literal">None</span>,
    t_r=<span class="hljs-literal">None</span>,  <span class="hljs-comment"># This shouldn't be necessary since we aren't bandpass filtering</span>
    reports=<span class="hljs-literal">False</span>,
)

<span class="hljs-comment"># Denoise the data by fitting and transforming the data file using the masker</span>
denoised_img_2d = masker.fit_transform(opj(<span class="hljs-string">"tedana_manual"</span>, data_file), confounds=orth_bad_timeseries)

<span class="hljs-comment"># Transform denoised data back into 4D space</span>
denoised_img_4d = masker.inverse_transform(denoised_img_2d)

<span class="hljs-comment"># Save to file</span>
denoised_img_4d.to_filename(
    opj(<span class="hljs-string">"func"</span>, <span class="hljs-string">"sub-04570_task-rest_space-scanner_descorthAggrDenoised_bold.nii.gz"</span>)
)
</code></pre></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">34</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark section-container present has-light-background fitted" data-background-color="#998c73" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-section" style="width: 100%; font-size: 1rem;">
        <div style="">
          <h3 id="youcanalsouse--tedort">You can also use <code class="hljs ada"><span class="hljs-comment">--tedort</span></code></h3>

<h4 id="butonlyconsiderscomponents">But only considers components,</h4>

<h4 id="noregressors">no regressors</h4>
        </div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">35</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
</section><section class="variable-size-headings has-footer dark default-container present has-light-background fitted" data-background-color="#958a76" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default" style="width: 100%; font-size: 1rem;">
        <div style=""><h4 id="recap">Recap</h4>

<ul>
<li><code class="hljs ebnf"><span class="hljs-attribute">tedana -d filenames -e echo_times</span></code></li>
<li>Automatic classification is not perfect: use Rica!</li>
<li>Rerun tedana with manual classification</li>
<li>Denoise with confounds if needed/interested</li>
</ul></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">36</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section><section class="variable-size-headings has-footer dark section-container present has-light-background fitted" data-background-color="#91897a" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-section" style="width: 100%; font-size: 1rem;">
        <div style="">
          <h3 id="alittleteaser">A little teaser</h3>
        </div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">37</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
</section><section class="variable-size-headings has-footer dark full-image-container present has-light-background fitted" data-background-color="#8c877d" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-full-image media-grid" style="width: 100%; font-size: 1rem;">
        <div style=""><div class="single-image-wrapper"><img src="images/recipe.png" class=" size-contain position-center-center"></div></div>
        
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">38</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
</section><section class="variable-size-headings has-footer dark default-container present has-light-background fitted" data-background-color="#888580" data-updated="true" style="display: grid;">

      <div class="header"><div class="leading"></div><div class="middle"></div><div class="trailing"></div></div>
      <div class="layout-default media-grid" style="width: 100%; font-size: 1rem;">
        <div style=""><div class="single-image-wrapper"><img src="images/qr.png" class=" size-contain position-center-center"></div><p></p>

<h1 id="thankyou">Thank you!</h1>

<p>Get in touch <a href="https://twitter.com/eurunuela">@eurunuela</a> or <a href="mailto:e.urunuela@bcbl.eu">e.urunuela@bcbl.eu</a></p></div>
      </div>
      <div class="footnotes"></div>
      <div class="footer"><div class="leading">39</div><div class="middle">enekourunuela.com</div><div class="trailing"><img class="logo" src="images/200611_spin_imagotipo_negativo.png"></div></div>
      
</section></div>
    </div>
    <script src="engine/index.js"></script>
    <script src="engine/d3v4.min.js" charset="utf-8"></script>
    <script src="engine/charts.min.js" charset="utf-8"></script>
    <script src="engine/billboard.min.js"></script>
    <script>
      Reveal.configure({
        progress: true,
        keyboard: true,
        dependencies: [
          {
            src: "engine/highlight.js",
            sync: true,
            callback: function () {
              hljs.initHighlightingOnLoad();
            },
          },
        ],
      });
    </script>
  </body>
</html>
